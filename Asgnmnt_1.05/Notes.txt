The next version of this code will need to be ported to C++. Need to research C++ and understand the differences
